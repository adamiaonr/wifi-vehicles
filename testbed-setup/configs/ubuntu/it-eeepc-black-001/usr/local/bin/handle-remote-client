#!/bin/bash

if [ $# -lt 2 ]
then
	echo "usage : $0 <protocol> <trace-nr> (if protocol = 'udp': <udp-bitrate>)"
	echo "options : "
	echo "    <protocol>    : 'tcp' or 'udp'"
	echo "    <trace-nr>    : nr. of trace to use in logs. 3 digit number w/ leading zeroes, e.g.: '041'"
	echo "    <udp-bitrate> : (optional) target bitrate in Mbps, if 'udp' is chosen as <protocol>, e.g. '50' for 50 Mbps."
	exit 1
fi

proto=$1
trace_nr=$2
bitrate=$3

# tp-03
# 	- start iperf3 clients in tp-01
# FIXME : harcoded login uses eth iface
ssh -i $HOME/.ssh/it "root@10.10.12.101" "(init-client $trace_nr > /dev/null 2>&1)&"
#/usr/local/bin/restart-remote-client $trace_nr "root@10.10.12.101" 192.168.0.147 5203 $proto $bitrate &
/usr/local/bin/restart-remote-client $trace_nr "root@10.10.12.101" 192.168.0.148 5204 $proto $bitrate &

exit 0
